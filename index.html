<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Rechtsgrundlagen – Prüfungsquiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --card-bg: #020617;
      --panel-bg: #020617;
      --accent: #2563eb;
      --accent-soft: rgba(37, 99, 235, 0.15);
      --accent-border: rgba(37, 99, 235, 0.6);
      --text: #e5e7eb;
      --text-soft: #9ca3af;
      --border-subtle: rgba(148, 163, 184, 0.5);
      --danger: #f97373;
      --danger-soft: rgba(248, 113, 113, 0.15);
      --success: #22c55e;
      --success-soft: rgba(34, 197, 94, 0.15);
      --radius-lg: 18px;
      --radius-md: 12px;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.8);
      --shadow-subtle: 0 6px 16px rgba(15, 23, 42, 0.9);
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        Roboto, Helvetica, Arial, sans-serif;
      background: #020617;
      color: var(--text);
      min-height: 100vh;
    }

    body {
      display: flex;
      justify-content: center;
      padding: 16px;
    }

    .app {
      width: 100%;
      max-width: 1100px;
      background: #020617;
      border-radius: 22px;
      padding: 18px 18px 20px;
      border: 1px solid rgba(51, 65, 85, 0.9);
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .app::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at top left, rgba(37, 99, 235, 0.14), transparent 55%),
        radial-gradient(circle at top right, rgba(15, 23, 42, 0.7), transparent 70%);
      pointer-events: none;
      opacity: 0.9;
      z-index: -1;
    }

    .app-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 12px;
    }

    .title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .app-title {
      font-size: 22px;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .app-title span {
      background: linear-gradient(120deg, #e5e7eb, #bfdbfe);
      -webkit-background-clip: text;
      color: transparent;
    }

    .tag-pill {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .16em;
      padding: 3px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      color: #cbd5f5;
      background: rgba(15, 23, 42, 0.95);
    }

    .subtitle {
      font-size: 12px;
      color: var(--text-soft);
      max-width: 780px;
    }

    .subtitle b {
      color: #e5e7eb;
      font-weight: 600;
    }

    .mode-info-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 2px;
      font-size: 11px;
      color: var(--text-soft);
    }

    .mode-info-row span {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.95);
    }

    .mode-info-row span strong {
      color: #e5e7eb;
      font-weight: 600;
    }

    .hidden {
      display: none !important;
    }

    /* Startseite – Moduswahl */

    .mode-select {
      margin-top: 10px;
      padding: 14px 14px 16px;
      border-radius: 18px;
      border: 1px solid var(--border-subtle);
      background: #020617;
      box-shadow: var(--shadow-subtle);
    }

    .mode-select-header {
      margin-bottom: 10px;
    }

    .mode-select-title {
      font-size: 13px;
      font-weight: 600;
      letter-spacing: .1em;
      text-transform: uppercase;
      color: #dbeafe;
    }

    .mode-select-subtitle {
      font-size: 12px;
      color: var(--text-soft);
      margin-top: 2px;
    }

    .mode-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .mode-card {
      border-radius: 16px;
      border: 1px solid var(--border-subtle);
      padding: 10px 11px 12px;
      background: #020617;
      color: inherit;
      cursor: pointer;
      text-align: left;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 88px;
      position: relative;
      overflow: hidden;
      transition: border-color 0.18s ease, box-shadow 0.18s ease,
        transform 0.12s ease, background 0.18s ease;
    }

    .mode-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top left, rgba(37, 99, 235, 0.14), transparent 60%);
      opacity: 0;
      transition: opacity 0.18s ease;
      pointer-events: none;
    }

    .mode-card:hover {
      border-color: var(--accent-border);
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.9);
      transform: translateY(-1px);
      background: #020617;
    }

    .mode-card:hover::after {
      opacity: 1;
    }

    .mode-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .mode-card h3 {
      font-size: 14px;
      margin: 0;
      color: #e5e7eb;
    }

    .mode-tag {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(96, 165, 250, 0.8);
      background: rgba(15, 23, 42, 0.96);
      color: #bfdbfe;
    }

    .mode-card p {
      font-size: 12px;
      color: var(--text-soft);
      margin: 4px 0 0;
    }

    .mode-stat {
      font-size: 11px;
      color: rgba(191, 219, 254, 0.9);
      margin-top: 6px;
    }

    /* Quiz-Hauptseite */

    .quiz-header-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-top: 6px;
      margin-bottom: 10px;
    }

    .mode-pill-current {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--accent-border);
      background: #020617;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #dbeafe;
    }

    .mode-pill-current small {
      color: rgba(191, 219, 254, 0.9);
      font-weight: 500;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 260px) minmax(0, 1.5fr);
      gap: 14px;
    }

    .info-column {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .info-card {
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      background: #020617;
      padding: 10px 11px 11px;
      font-size: 12px;
      box-shadow: var(--shadow-subtle);
    }

    .info-card h3 {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: #9ca3af;
      margin: 0 0 6px;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 6px;
    }

    .info-item {
      display: flex;
      flex-direction: column;
      gap: 2px;
      padding: 6px 7px;
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: #020617;
    }

    .info-item-label {
      font-size: 11px;
      color: var(--text-soft);
    }

    .info-item-value {
      font-size: 13px;
      font-weight: 600;
      color: #e5e7eb;
    }

    .info-small {
      font-size: 11px;
      color: var(--text-soft);
      margin-top: 4px;
    }

    .score-banner {
      margin-top: 4px;
      padding: 8px 9px;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: #020617;
      font-size: 12px;
      color: #dbeafe;
      box-shadow: var(--shadow-subtle);
    }

    .score-banner.positive {
      border-color: rgba(34, 197, 94, 0.8);
      box-shadow: 0 12px 28px rgba(22, 163, 74, 0.5);
    }

    .score-banner.negative {
      border-color: rgba(248, 113, 113, 0.9);
      box-shadow: 0 12px 28px rgba(248, 113, 113, 0.4);
    }

    .score-main {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 6px;
      margin-bottom: 3px;
    }

    .score-percent {
      font-size: 20px;
      font-weight: 700;
    }

    .score-grade {
      font-size: 13px;
      font-weight: 600;
    }

    .score-details {
      font-size: 11px;
      color: rgba(191, 219, 254, 0.9);
    }

    .question-column {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .question-card {
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      background: #020617;
      padding: 12px 14px 13px;
      box-shadow: var(--shadow-subtle);
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 6px;
    }

    .question-number {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #9ca3af;
    }

    .question-topic {
      font-size: 11px;
      color: var(--text-soft);
      text-align: right;
    }

    .question-text {
      font-size: 14px;
      margin-bottom: 6px;
    }

    .question-context {
      font-size: 11px;
      color: #e5e7eb;
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: #020617;
      padding: 7px 8px;
      margin-bottom: 6px;
      max-height: 260px;
      overflow: auto;
    }

    .question-context pre {
      margin: 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      white-space: pre;
    }

    .question-note {
      font-size: 11px;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 6px;
    }

    .option {
      position: relative;
      display: flex;
      align-items: flex-start;
      gap: 7px;
      padding: 7px 9px;
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: #020617;
      cursor: pointer;
      font-size: 13px;
      transition: border-color 0.15s ease, background 0.15s ease,
        transform 0.06s ease;
    }

    .option:hover {
      border-color: var(--accent-border);
      background: #020617;
      transform: translateY(-0.5px);
    }

    .option input[type="checkbox"] {
      margin-top: 2px;
      accent-color: var(--accent);
      width: 15px;
      height: 15px;
      flex-shrink: 0;
      cursor: pointer;
    }

    .option-letter {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-soft);
      margin-top: 1px;
      flex-shrink: 0;
      width: 22px;
    }

    .option-text {
      flex: 1;
    }

    .option.correct {
      border-color: rgba(34, 197, 94, 0.9);
      background: var(--success-soft);
    }

    .option.incorrect {
      border-color: rgba(248, 113, 113, 0.95);
      background: var(--danger-soft);
    }

    .option.unselected-correct {
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.7) inset;
    }

    .explanation {
      font-size: 11px;
      padding: 7px 9px;
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: #020617;
      color: var(--text-soft);
      margin-top: 4px;
    }

    .explanation strong {
      color: #e5e7eb;
    }

    .message {
      font-size: 11px;
      margin-top: 3px;
      color: #fde68a;
    }

    .nav-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-top: 4px;
    }

    .nav-row.second {
      justify-content: flex-end;
      margin-top: 3px;
      gap: 6px;
    }

    button {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      font-size: 12px;
      padding: 7px 13px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #020617;
      color: #e5e7eb;
      border: 1px solid rgba(55, 65, 81, 0.9);
      transition: background 0.15s ease, transform 0.1s ease,
        box-shadow 0.15s ease, border-color 0.15s ease;
    }

    button:hover {
      background: rgba(15, 23, 42, 0.95);
      border-color: var(--accent-border);
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.95);
      transform: translateY(-0.5px);
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.95);
    }

    button.primary {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      border-color: rgba(37, 99, 235, 0.9);
      color: #f9fafb;
      box-shadow: 0 12px 24px rgba(37, 99, 235, 0.7);
    }

    button.primary:hover {
      background: linear-gradient(135deg, #1d4ed8, #1e40af);
    }

    button.small {
      padding: 5px 10px;
      font-size: 11px;
    }

    button:disabled {
      opacity: 0.4;
      cursor: default;
      transform: none;
      box-shadow: none;
      background: #020617;
    }

    /* Lösungs-Overlay */

    .solution-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.96);
      backdrop-filter: blur(4px);
      z-index: 50;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 16px;
      overflow-y: auto;
    }

    .solution-panel {
      width: 100%;
      max-width: 980px;
      background: #020617;
      border-radius: 20px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      box-shadow: 0 18px 40px rgba(15, 23, 42, 1);
      padding: 14px 16px 16px;
    }

    .solution-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      gap: 8px;
    }

    .solution-header h2 {
      margin: 0;
      font-size: 16px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #dbeafe;
    }

    .solution-summary {
      font-size: 12px;
      color: var(--text-soft);
      margin-bottom: 8px;
    }

    .solution-summary b {
      color: #e5e7eb;
    }

    .solution-list {
      margin-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: calc(100vh - 140px);
      overflow-y: auto;
      padding-right: 4px;
    }

    .solution-question {
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: #020617;
      padding: 8px 9px 9px;
      font-size: 12px;
    }

    .solution-q-header {
      display: flex;
      justify-content: space-between;
      gap: 6px;
      margin-bottom: 3px;
      align-items: baseline;
    }

    .solution-q-title {
      font-size: 12px;
      font-weight: 600;
    }

    .solution-q-topic {
      font-size: 11px;
      color: var(--text-soft);
      text-align: right;
    }

    .solution-q-score {
      font-size: 11px;
      color: #e5e7eb;
      margin-top: 2px;
    }

    .solution-q-score.positive {
      color: var(--success);
    }

    .solution-q-score.negative {
      color: var(--danger);
    }

    .solution-options {
      margin-top: 4px;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .solution-opt {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      font-size: 12px;
    }

    .solution-opt-mark {
      width: 18px;
      text-align: center;
      font-size: 11px;
    }

    .opt-correct {
      color: var(--success);
    }

    .opt-wrong-selected {
      color: var(--danger);
    }

    .opt-neutral {
      color: var(--text-soft);
    }

    .solution-expl {
      margin-top: 4px;
      font-size: 11px;
      color: var(--text-soft);
    }

    /* Responsiv */

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
      .info-column {
        order: -1;
      }
    }

    @media (max-width: 720px) {
      body {
        padding: 10px;
      }
      .app {
        padding: 14px 12px 16px;
        border-radius: 18px;
      }
      .app-title {
        font-size: 19px;
      }
      .mode-grid {
        grid-template-columns: minmax(0, 1fr);
      }
      .quiz-header-bar {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title-row">
        <div class="app-title">
          <span>Rechtsgrundlagen – Prüfungsquiz</span>
        </div>
        <div class="tag-pill">Öffentliches Recht · Privatrecht · Grundbuch</div>
      </div>
      <p class="subtitle">
        Mehrfachauswahl wie in der Prüfung: <b>mindestens eine Antwort ist richtig</b>, aber nie alle.
        Falsche Kreuze kosten Punkte.
      </p>
      <div class="mode-info-row">
        <span><strong>Bewertung:</strong> ab 60&nbsp;% insgesamt positiv</span>
        <span><strong>Frage:</strong> richtige Anteile bringen Punkte, falsche Abzüge</span>
      </div>
    </header>

    <!-- STARTSEITE – MODUSWAHL -->
    <section id="mode-select" class="mode-select">
      <div class="mode-select-header">
        <div class="mode-select-title">Modus wählen</div>
        <div class="mode-select-subtitle">
          Entweder alle Themen gemischt oder nur Grundbuchauszüge trainieren.
        </div>
      </div>
      <div class="mode-grid">
        <button class="mode-card" data-mode="all">
          <div class="mode-card-header">
            <h3>Gesamt-Quiz: Öffentliches &amp; Privatrecht</h3>
            <span class="mode-tag">Modus A</span>
          </div>
          <p>
            Fragen zu Verfassungsrecht, Verwaltung, BauO, Privatrecht, Verträgen,
            Gewährleistung/Schadenersatz/Produkthaftung, Sachenrecht und Grundbuch-Basics.
          </p>
          <div class="mode-stat">ca. 60 Fragen · Niveau wie Prüfung</div>
        </button>

        <button class="mode-card" data-mode="grundbuch">
          <div class="mode-card-header">
            <h3>Spezial: Grundbuchauszüge lesen</h3>
            <span class="mode-tag">Modus B</span>
          </div>
          <p>
            Mehrere längere, fiktive Grundbuchsauszüge im Stil echter Auszüge –
            mit Fragen zu A-, B- und C-Blatt, Rang, Dienstbarkeiten, Hypotheken, Plombe.
          </p>
          <div class="mode-stat">12 Lernfragen mit Fällen</div>
        </button>
      </div>
    </section>

    <!-- QUIZ-SEITE -->
    <main id="quiz-main" class="hidden">
      <div class="quiz-header-bar">
        <div class="mode-pill-current">
          <span>Aktiver Modus</span>
          <small id="current-mode-label">–</small>
        </div>
        <div style="display:flex; gap:6px; flex-wrap:wrap;">
          <button id="restart-btn" class="small">Neues Quiz in diesem Modus</button>
          <button id="back-btn" class="small">Zur Moduswahl</button>
        </div>
      </div>

      <div class="layout">
        <section class="info-column">
          <div id="progress-info" class="info-card">
            <h3>Fortschritt</h3>
            <div class="info-grid">
              <div class="info-item">
                <div class="info-item-label">Frage</div>
                <div class="info-item-value" id="info-current-question">–</div>
              </div>
              <div class="info-item">
                <div class="info-item-label">Insgesamt</div>
                <div class="info-item-value" id="info-total-questions">–</div>
              </div>
              <div class="info-item">
                <div class="info-item-label">Geprüft</div>
                <div class="info-item-value" id="info-checked">–</div>
              </div>
              <div class="info-item">
                <div class="info-item-label">Ø Punkte (geprüft)</div>
                <div class="info-item-value" id="info-average">–</div>
              </div>
            </div>
            <div class="info-small">
              Pro Frage: richtige Anteile bringen Punkte, falsche Kreuze ziehen ab.
            </div>
          </div>

          <div id="score-banner" class="score-banner hidden">
            <div class="score-main">
              <span class="score-percent" id="score-percent">0&nbsp;%</span>
              <span class="score-grade" id="score-grade">Note –</span>
            </div>
            <div class="score-details" id="score-details">
              Noch keine Gesamtauswertung.
            </div>
          </div>
        </section>

        <section class="question-column">
          <div id="question-container"></div>

          <div class="nav-row">
            <button id="prev-btn" type="button">◀ Zurück</button>
            <button id="check-btn" type="button" class="primary">Antwort prüfen</button>
            <button id="next-btn" type="button">Weiter ▶</button>
          </div>
          <div class="nav-row second">
            <button id="eval-btn" type="button" class="primary">
              Gesamtes Quiz auswerten
            </button>
          </div>
        </section>
      </div>
    </main>

    <!-- LÖSUNGEN / GESAMTAUSWERTUNG -->
    <div id="solution-overlay" class="solution-overlay hidden">
      <div class="solution-panel">
        <div class="solution-header">
          <h2>Gesamtauswertung &amp; Lösungen</h2>
          <button id="close-solution-btn" class="small">Schließen ✕</button>
        </div>
        <div id="solution-summary" class="solution-summary"></div>
        <div id="solution-list" class="solution-list"></div>
      </div>
    </div>
  </div>

  <script>
    // =========================================
    // FRAGEN – GESAMT-MODUS (verkürzt hier)
    // =========================================

    const ALL_QUESTIONS = [
      // --- Öffentliches / Privatrecht Grundlagen ---
      {
        id: 1,
        topic: "Rechtsgebiete – Grundlagen",
        text: "Welche Aussagen zum Privatrecht sind zutreffend?",
        options: [
          "Privatrecht regelt Rechtsbeziehungen, bei denen sich die Beteiligten gleichberechtigt gegenüberstehen.",
          "Für die Rechtsdurchsetzung im Privatrecht sind Zivilgerichte zuständig.",
          "Privatrecht regelt die Ausübung hoheitlicher Macht durch den Staat.",
          "Privatrecht regelt die Zuständigkeit und Tätigkeit von Bundes- und Landesbehörden."
        ],
        correctIndices: [0, 1],
        explanation:
          "Privatrecht (Zivilrecht) betrifft gleichberechtigte Beziehungen zwischen Privaten; zuständig sind ordentliche Gerichte. Hoheitsverwaltung und Behördenzuständigkeit gehören zum öffentlichen Recht."
      },
      {
        id: 2,
        topic: "Rechtsgebiete – Grundlagen",
        text: "Welche Aussagen zum Öffentlichen Recht sind richtig?",
        options: [
          "Öffentliches Recht regelt u.a. die Tätigkeit von mit Hoheitsgewalt ausgestatteten Rechtsträgern.",
          "Öffentliches Recht regelt Rechtsbeziehungen, bei denen sich die Beteiligten gleichberechtigt gegenüberstehen.",
          "Zum öffentlichen Recht zählen z.B. Verfassungsrecht und Verwaltungsrecht.",
          "Im öffentlichen Recht geht es niemals um hoheitliche Macht."
        ],
        correctIndices: [0, 2],
        explanation:
          "Öffentliches Recht betrifft hoheitliche Tätigkeit (Bund, Länder, Gemeinden). Verfassungs- und Verwaltungsrecht sind zentrale Teilgebiete."
      },
      {
        id: 3,
        topic: "Rechtsquellen – Zwingendes / dispositives Recht",
        text: "Welche Aussagen zu zwingendem und dispositivem Recht treffen zu?",
        options: [
          "Absolut zwingendes Recht kann durch Parteienvereinbarung überhaupt nicht abgeändert werden.",
          "Relativ zwingendes Recht kann nur zugunsten eines bestimmten Vertragspartners abgeändert werden.",
          "Dispositives Recht kann durch vertragliche Vereinbarung geändert werden, solange keine zwingenden Normen verletzt werden.",
          "Dispositives Recht wird auch absolut zwingendes Recht genannt."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Absolut zwingendes Recht ist gar nicht veränderbar, relativ zwingendes nur zugunsten einer Partei. Dispositives Recht ist „nachgiebig“ und kann vertraglich ersetzt werden."
      },
      {
        id: 4,
        topic: "Stufenbau der Rechtsordnung",
        text: "Welche Aussagen zum Stufenbau der Rechtsordnung sind richtig?",
        options: [
          "Verordnungen sind Normen mit genereller Rechtskraft und müssen dem Gesetz entsprechen.",
          "Nationale Verordnungen und EU-Verordnungen sind immer gleichrangig.",
          "Das EU-Recht hat Anwendungsvorrang, steht aber nicht einfach „über“ der österreichischen Verfassung.",
          "Eine rangniedrigere Norm darf nur auf Grundlage einer höheren Norm erlassen werden und darf ihr nicht widersprechen."
        ],
        correctIndices: [0, 3],
        explanation:
          "Verordnungen brauchen eine gesetzliche Grundlage. Rangniedrigere Normen müssen inhaltlich und formal auf eine höherrangige Norm gestützt sein und dürfen ihr nicht widersprechen."
      },
      {
        id: 5,
        topic: "Verfassungsprinzipien",
        text: "Das demokratische Prinzip im engeren Sinn besagt unter anderem, dass …",
        options: [
          "alle Staatsbürger an der Staatswillensbildung beteiligt sind und damit Träger der Staatsgewalt sind.",
          "Österreich in Bundesländer mit eigenen Kompetenzen aufgeteilt ist.",
          "Österreich ein gewähltes Staatsoberhaupt hat.",
          "die Staatsbürger gegenüber dem Staat Grund- und Freiheitsrechte haben."
        ],
        correctIndices: [0],
        explanation:
          "Kern des demokratischen Prinzips ist die Beteiligung der Staatsbürger an der Staatswillensbildung (Souveränität)."
      },
      {
        id: 6,
        topic: "Verfassungsprinzipien / Gewaltentrennung",
        text: "Welche Aussagen zum gewaltentrennenden Prinzip sind zutreffend?",
        options: [
          "Es trennt Gesetzgebung, Verwaltung und Gerichtsbarkeit, um Machtkonzentration zu verhindern.",
          "Es wird auch Föderalismus genannt.",
          "Es bedeutet, dass die Staatsfunktionen von unterschiedlichen, weitgehend unabhängigen Organen ausgeübt werden.",
          "Es umfasst hauptsächlich die Grund- und Freiheitsrechte."
        ],
        correctIndices: [0, 2],
        explanation:
          "Gewaltenteilung trennt die Funktionen Gesetzgebung, Vollziehung und Gerichtsbarkeit und ordnet sie verschiedenen Organen zu."
      },
      {
        id: 7,
        topic: "Bundesgesetzgebung",
        text: "Welche Aussagen zur Bundesgesetzgebung sind richtig?",
        options: [
          "Der Nationalrat beschließt Bundesgesetze, der Bundesrat wirkt mit.",
          "Der Bundespräsident beurkundet Bundesgesetze vor der Kundmachung.",
          "Die Gesetzgebungsperiode des Nationalrats dauert grundsätzlich 5 Jahre.",
          "Die Bundesregierung kann einfache Gesetze ohne Nationalrat beschließen."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Gesetze werden im Parlament beschlossen, vom Bundespräsidenten beurkundet und im BGBl. kundgemacht. Die Bundesregierung kann selbst keine Gesetze erlassen."
      },
      {
        id: 8,
        topic: "Höchstgerichte",
        text: "Welche Aussagen zu den österreichischen Höchstgerichten sind korrekt?",
        options: [
          "Der Verfassungsgerichtshof prüft u.a. Gesetze und Verordnungen auf Verfassungsmäßigkeit.",
          "Der Verwaltungsgerichtshof kontrolliert Entscheidungen der Verwaltungsgerichte.",
          "Der Oberste Gerichtshof ist Höchstgericht in Zivil- und Strafsachen.",
          "Der EuGH hebt österreichische Verfassungsbestimmungen auf, wenn sie ihm nicht gefallen."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "VfGH, VwGH und OGH sind die drei österreichischen Höchstgerichte. Der EuGH entscheidet über EU-Rechtsfragen, aber nicht direkt über österreichische Verfassungsbestimmungen."
      },
      {
        id: 9,
        topic: "Justiz / ordentliche Gerichtsbarkeit",
        text: "Welche Aussagen zur ordentlichen Gerichtsbarkeit treffen zu?",
        options: [
          "Ordentliche Gerichte sind für Zivil- und Strafsachen zuständig, soweit nicht Verwaltungsbehörden zuständig sind.",
          "Gerichtsverfahren sind grundsätzlich mündlich und öffentlich.",
          "Es gibt eine Geschäftsverteilung, die regelt, welcher Richter für welche Fälle zuständig ist.",
          "Ordentliche Gerichte vollziehen ausschließlich Verwaltungsrecht."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Ordentliche Gerichte (BG, LG, OLG, OGH) verhandeln Zivil- und Strafsachen. Die Zuständigkeit ist durch Geschäftsverteilung geregelt."
      },

      // --- Verwaltung / Verwaltungsverfahren / Verwaltungsstrafrecht ---
      {
        id: 10,
        topic: "Verwaltung – Begriff",
        text: "Welche Aussagen zur Verwaltung sind richtig?",
        options: [
          "Verwaltung ist alle staatliche Vollziehung, die nicht Gesetzgebung oder Gerichtsbarkeit ist.",
          "Verwaltung wird von Verwaltungsbehörden ausgeübt.",
          "Verwaltung kann hoheitlich oder privatrechtlich erfolgen.",
          "Verwaltung ist ein anderer Begriff für Gerichtsbarkeit."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Zur Verwaltung gehören hoheitliche Akte (Bescheide, Verordnungen) und privatrechtliches Handeln (z.B. Verträge der öffentlichen Hand)."
      },
      {
        id: 11,
        topic: "Hoheitsverwaltung – Handlungsformen",
        text: "Welche Handlungsformen gehören zur Hoheitsverwaltung?",
        options: [
          "Verordnungen.",
          "Bescheide.",
          "Urteile.",
          "Privatwirtschaftliche Verträge der Gemeinde."
        ],
        correctIndices: [0, 1],
        explanation:
          "Verordnungen und Bescheide sind typische hoheitliche Akte der Verwaltung. Urteile stammen von Gerichten, Verträge sind privatwirtschaftliches Handeln."
      },
      {
        id: 12,
        topic: "Bescheid",
        text: "Welche Wesensmerkmale eines Bescheids sind zutreffend?",
        options: [
          "Er richtet sich an einen bestimmten individuellen Adressatenkreis.",
          "Er ist ein hoheitlicher Akt einer Verwaltungsbehörde.",
          "Er wird durch Zustellung oder Verkündung rechtswirksam.",
          "Er ist eine generelle Norm mit unbestimmtem Adressatenkreis."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Bescheide sind individuelle Verwaltungsakte. Generelle Normen mit unbestimmtem Adressatenkreis sind Gesetze oder Verordnungen."
      },
      {
        id: 13,
        topic: "Parteistellung",
        text: "Mit der Parteistellung im Verwaltungsverfahren sind welche Rechte verbunden?",
        options: [
          "Recht auf Akteneinsicht.",
          "Recht, Rechtsmittel zu erheben.",
          "Rechtsanspruch auf Entscheidung der Behörde innerhalb angemessener Frist.",
          "Nur mündliche Verkündung, aber keine Zustellung des Bescheids."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Parteistellung sichert u.a. Akteneinsicht, Parteiengehör, Rechtsmittelrecht und Anspruch auf Entscheidung."
      },
      {
        id: 14,
        topic: "Verwaltungsverfahrensrecht – Rechtsquellen",
        text: "Welche Rechtsquellen gehören insbesondere zum Verwaltungsverfahrensrecht?",
        options: [
          "Allgemeines Verwaltungsverfahrensgesetz (AVG).",
          "Zustellgesetz (ZustG).",
          "Verwaltungsstrafgesetz (VStG).",
          "Strafprozessordnung (StPO)."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "AVG, ZustG und VStG regeln das Verwaltungsverfahren; StPO betrifft das gerichtliche Strafverfahren."
      },
      {
        id: 15,
        topic: "Zustellung",
        text: "Welche Aussagen zur Zustellung behördlicher Schriftstücke treffen zu?",
        options: [
          "RSa bedeutet, dass nur der Empfänger selbst übernehmen darf.",
          "RSb erlaubt die Übergabe auch an andere Empfangsberechtigte im Haushalt.",
          "Bei Hinterlegung gilt das Schriftstück mit dem ersten Tag der Abholfrist als zugestellt.",
          "Die Rechtsmittelfrist ist gewahrt, wenn das Schriftstück am ersten Tag nach Fristablauf zur Post gegeben wird."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "RSa: nur Empfänger; RSb: Haushaltsangehörige; Hinterlegung: Zustellung mit 1. Tag der Abholfrist. Für Fristen zählt die Aufgabe am letzten Tag."
      },
      {
        id: 16,
        topic: "Beschwerde / Beschwerdevorentscheidung",
        text: "Welche Aussagen zur Bescheidbeschwerde sind richtig?",
        options: [
          "Sie ist grundsätzlich binnen vier Wochen ab Zustellung einzubringen.",
          "Sie ist bei der bescheiderlassenden Behörde einzubringen.",
          "Die Behörde kann eine Beschwerdevorentscheidung erlassen.",
          "Gegen eine Beschwerdevorentscheidung gibt es keine weitere Möglichkeit."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Die Beschwerde wird bei der Ausgangsbehörde eingebracht. Diese kann eine Beschwerdevorentscheidung treffen; dagegen ist ein Vorlageantrag an das Verwaltungsgericht möglich."
      },
      {
        id: 17,
        topic: "Verwaltungsstrafrecht – Rechtsquellen",
        text: "Welche Aussagen zu den Rechtsquellen des Verwaltungsstrafrechts sind korrekt?",
        options: [
          "Verwaltungsstrafbestimmungen und Strafausmaß stehen im Strafgesetzbuch (StGB).",
          "Verwaltungsstrafbestimmungen und Strafausmaß finden sich in den jeweiligen Materiengesetzen (z.B. BauO).",
          "Das Verwaltungsstrafgesetz regelt den Ablauf des Verwaltungsstrafverfahrens.",
          "Der Ablauf des Verwaltungsstrafverfahrens ist ausschließlich in der Strafprozessordnung geregelt."
        ],
        correctIndices: [1, 2],
        explanation:
          "Die einzelnen Tatbestände stehen in Materiengesetzen; das VStG regelt das Verwaltungsstrafverfahren."
      },
      {
        id: 18,
        topic: "Fahrlässigkeit",
        text: "Welche Aussage zur Fahrlässigkeit ist NICHT zutreffend?",
        options: [
          "Fahrlässig handelt, wer die gebotene Sorgfalt außer Acht lässt.",
          "Fahrlässig handelt, wer geistig und körperlich fähig wäre, die Sorgfalt einzuhalten.",
          "Fahrlässigkeit liegt auch bei Unzurechnungsfähigkeit vor.",
          "Maßstab ist u.a., was einem Täter zugemutet werden kann."
        ],
        correctIndices: [2],
        explanation:
          "Unzurechnungsfähige sind strafrechtlich grundsätzlich nicht verantwortlich; Fahrlässigkeit setzt Zurechnungsfähigkeit voraus."
      },

      // --- Raumordnung / BauO / Gewerbe ---
      {
        id: 19,
        topic: "Raumordnung – Flächenwidmungsplan",
        text: "Welche Aussagen zum Flächenwidmungsplan sind richtig?",
        options: [
          "Er ist grundsätzlich eine Verordnung der Gemeinde und teilt das Gemeindegebiet in Widmungskategorien ein.",
          "Er wird als Bescheid von der Baubehörde an jeden Grundeigentümer zugestellt.",
          "Er unterliegt der Aufsicht der jeweiligen Landesregierung.",
          "Er ist Grundlage für Baubewilligungen, da in der Regel Baulandwidmung erforderlich ist."
        ],
        correctIndices: [0, 2, 3],
        explanation:
          "Flächenwidmungspläne sind Verordnungen der Gemeinde, stehen unter Landesaufsicht und sind zentrale Grundlage für Baubewilligungen."
      },
      {
        id: 20,
        topic: "Gewerberecht – Gewerbeberechtigung",
        text: "Wann ist eine Gewerbeberechtigung nach der GewO erforderlich?",
        options: [
          "Bei Ausübung eines freien Gewerbes.",
          "Bei Ausübung eines reglementierten Gewerbes.",
          "Nie, wenn keine Betriebsanlagengenehmigung notwendig ist.",
          "Nicht, wenn die Tätigkeit ausdrücklich von der GewO ausgenommen ist."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Sowohl freie als auch reglementierte Gewerbe sind anzeigepflichtig bzw. bewilligungspflichtig. Ausgenommene Tätigkeiten fallen nicht unter die GewO."
      },

      // --- Privatrecht / Verträge / AGB / Sicherheiten ---
      {
        id: 21,
        topic: "Privatrechtsquellen",
        text: "Welche Aussagen zu den Privatrechtsquellen sind richtig?",
        options: [
          "Das ABGB ist das Basisgesetz des österreichischen Privatrechts.",
          "Sonderprivatrechtsgesetze gehen als speziellere Normen dem ABGB vor.",
          "Sonderprivatrechtsgesetze dürfen keine abweichenden Regelungen enthalten.",
          "Das ABGB gilt subsidiär, wenn kein spezielleres Privatrechtsgesetz eingreift."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Spezialgesetze (Mietrecht, KSchG usw.) gehen vor; das ABGB ergänzt subsidiär."
      },
      {
        id: 22,
        topic: "Geschäftsfähigkeit",
        text: "Geschäftsfähigkeit: Welche Aussagen zu einer 16-jährigen Person sind richtig (vereinfacht)?",
        options: [
          "Sie kann über eigenes Einkommen verfügen, soweit Lebensbedürfnisse nicht gefährdet werden.",
          "Sie ist voll geschäftsfähig.",
          "Sie darf alterstypische Geschäfte abschließen und Schenkungen ohne Bedingungen annehmen.",
          "Sie kann überhaupt keine wirksamen Rechtsgeschäfte abschließen."
        ],
        correctIndices: [0, 2],
        explanation:
          "Jugendliche sind beschränkt geschäftsfähig: bestimmte Geschäfte sind möglich, aber nicht alle."
      },
      {
        id: 23,
        topic: "Vertragsabschluss",
        text: "Welche Voraussetzungen sind für einen gültigen Vertrag im Regelfall erforderlich?",
        options: [
          "Übereinstimmende Willenserklärungen (Anbot und Annahme).",
          "Geschäftsfähigkeit der Parteien.",
          "Immer Schriftlichkeit – sonst ist der Vertrag unwirksam.",
          "Kein Verstoß gegen zwingendes Recht oder gute Sitten."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Essentiell sind Anbot/Annahme, Geschäftsfähigkeit und zulässiger Vertragsinhalt. Schriftlichkeit ist nur ausnahmsweise zwingend."
      },
      {
        id: 24,
        topic: "AGB",
        text: "Welche Aussagen zu Allgemeinen Geschäftsbedingungen (AGB) treffen zu?",
        options: [
          "AGB gelten, wenn auf sie hingewiesen und sie akzeptiert werden.",
          "AGB werden für immer wieder gleichartig abgeschlossene Verträge erstellt.",
          "Unklare Klauseln werden zum Nachteil des Verwenders ausgelegt (Transparenzgebot).",
          "AGB sind gegenüber Konsumenten immer unzulässig."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "AGB sind zulässig, müssen aber transparent sein und wirksam einbezogen werden."
      },
      {
        id: 25,
        topic: "Kostenvoranschlag – Verbraucher",
        text: "Welche Aussagen zum Kostenvoranschlag an Verbraucher (ohne besondere Vereinbarung) sind korrekt?",
        options: [
          "Er ist kostenlos.",
          "Der genannte Preis gilt als verbindlich.",
          "Die Erstellung ist kostenpflichtig.",
          "Der genannte Preis ist unverbindlich."
        ],
        correctIndices: [0, 1],
        explanation:
          "Nach KSchG ist der KV im Zweifel kostenlos und verbindlich, sofern nichts anderes vereinbart wurde."
      },
      {
        id: 26,
        topic: "Sicherheiten – Eigentumsvorbehalt",
        text: "Welche Aussagen zum Eigentumsvorbehalt sind richtig?",
        options: [
          "Vereinbarung, dass der Käufer erst mit vollständiger Zahlung Eigentümer wird.",
          "Ohne Eigentumsvorbehalt wird der Käufer mit Übergabe Eigentümer.",
          "Bei Insolvenz des Käufers kann der Verkäufer die Sache aussondern, wenn ein Eigentumsvorbehalt besteht.",
          "Eigentumsvorbehalt gilt automatisch bei jedem Kauf, auch ohne Vereinbarung."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Der Eigentumsvorbehalt muss ausdrücklich vereinbart werden; er sichert den Verkäufer bei Nichtzahlung/Insolvenz."
      },
      {
        id: 27,
        topic: "Sicherheiten – Bankgarantie",
        text: "Welche Aussagen zur Bankgarantie treffen zu?",
        options: [
          "Sie ist ein abstraktes Zahlungsversprechen einer Bank zugunsten eines Dritten.",
          "Sie wird u.a. zur Sicherung eines Haftrücklasses verwendet.",
          "Sie ist streng akzessorisch vom Bestand des Grundgeschäfts abhängig.",
          "Sie ist grundsätzlich vom Grundgeschäft rechtlich unabhängig."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Bankgarantie ist ein abstraktes Sicherungsinstrument; der Begünstigte kann Zahlung verlangen, wenn die vereinbarten Bedingungen eintreten."
      },
      {
        id: 28,
        topic: "Konventionalstrafe",
        text: "Welche Aussagen zur Konventionalstrafe (= Pönale) sind korrekt?",
        options: [
          "Sie ist ein pauschalierter Schadenersatz für den Fall der Schlechterfüllung oder Nichterfüllung.",
          "Sie ist grundsätzlich verschuldensabhängig.",
          "Das Gericht kann eine überhöhte Konventionalstrafe mäßigen.",
          "Sie kann vertraglich nicht vereinbart werden."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Die Konventionalstrafe wird vertraglich vereinbart, ist verschuldensabhängig und unterliegt dem richterlichen Mäßigungsrecht."
      },
      {
        id: 29,
        topic: "Lieferverzug / Annahmeverzug",
        text: "Welche Aussagen sind richtig (vereinfacht)?",
        options: [
          "Beim absoluten Fixgeschäft zerfällt der Vertrag bei Nichterfüllung zum vereinbarten Termin.",
          "Beim Termingeschäft kann nach Nachfristsetzung vom Vertrag zurückgetreten werden.",
          "Im Annahmeverzug trägt der Gläubiger die Gefahr des zufälligen Unterganges.",
          "Bei Verzug bestehen nie Schadenersatzansprüche."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Fixgeschäft: Vertrag fällt bei Nichterfüllung automatisch; Termingeschäft: Nachfrist + Rücktritt; im Annahmeverzug geht die Gefahr auf den Gläubiger über."
      },

      // --- Gewährleistung / Schadenersatz / Produkthaftung ---
      {
        id: 30,
        topic: "Gewährleistung – Grundlagen",
        text: "Welche Aussagen zur Gewährleistung sind richtig (vereinfacht)?",
        options: [
          "Der Mangel muss bei Übergabe vorhanden sein.",
          "Gewährleistung ist verschuldensunabhängig.",
          "Regelmäßige Frist: 2 Jahre bewegliche, 3 Jahre unbewegliche Sachen.",
          "Zwischen Unternehmer und Verbraucher kann Gewährleistung völlig ausgeschlossen werden."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Gewährleistung knüpft an den Zeitpunkt der Übergabe an, ist verschuldensunabhängig und im Verbrauchergeschäft zwingend."
      },
      {
        id: 31,
        topic: "Gewährleistung – Beweislastumkehr",
        text: "Welche Aussagen zur Beweislastumkehr im Verbrauchergeschäft sind zutreffend?",
        options: [
          "Tritt ein Mangel innerhalb von 6 Monaten auf, wird vermutet, dass er bei Übergabe vorhanden war.",
          "In den ersten 6 Monaten muss der Unternehmer beweisen, dass die Sache mangelfrei war.",
          "In den ersten 6 Monaten trägt immer der Verbraucher die volle Beweislast.",
          "Bei typischen Verschleißteilen kann die Vermutung ausgeschlossen sein."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Die Vermutung wirkt zugunsten des Verbrauchers; der Unternehmer muss ggf. das Gegenteil beweisen."
      },
      {
        id: 32,
        topic: "Gewährleistung – Rechtsbehelfe",
        text: "Welche Gewährleistungsbehelfe stehen dem Käufer zu?",
        options: [
          "Verbesserung (Reparatur).",
          "Austausch.",
          "Preisminderung.",
          "Wandlung."
        ],
        correctIndices: [0, 1, 2, 3],
        explanation:
          "Primär Verbesserung oder Austausch; sekundär Preisminderung oder Wandlung."
      },
      {
        id: 33,
        topic: "Schadenersatz – Voraussetzungen",
        text: "Welche Voraussetzungen müssen für Schadenersatzansprüche typischerweise vorliegen?",
        options: [
          "Schaden.",
          "Rechtswidrigkeit.",
          "Verschulden (außer bei Gefährdungshaftung).",
          "Zufall ohne Rechtswidrigkeit."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Klassisch: Schaden, Rechtswidrigkeit, Kausalität, Verschulden."
      },
      {
        id: 34,
        topic: "Erfüllungsgehilfenhaftung",
        text: "Welche Regelung beschreibt § 1313a ABGB?",
        options: [
          "Erfüllungsgehilfenhaftung.",
          "Amtshaftung.",
          "Produkthaftung.",
          "Organhaftung."
        ],
        correctIndices: [0],
        explanation:
          "Der Schuldner haftet für Verschulden seiner Erfüllungsgehilfen wie für eigenes."
      },
      {
        id: 35,
        topic: "Produkthaftung",
        text: "Welche Aussagen zur Produkthaftung sind korrekt (vereinfacht)?",
        options: [
          "Sie ist verschuldensunabhängig.",
          "Die absolute Frist beträgt 10 Jahre ab Inverkehrbringen.",
          "Sie ersetzt alle Gewährleistungsrechte.",
          "Sie betrifft v.a. Personen- und bestimmte Sachschäden."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Produkthaftung ergänzt die Gewährleistung; absolute Verjährung nach 10 Jahren."
      },
      {
        id: 36,
        topic: "Verjährung",
        text: "Welche Aussagen zur Verjährung treffen zu?",
        options: [
          "Verjährung macht den Anspruch gerichtlich nicht mehr durchsetzbar, er kann aber freiwillig erfüllt werden.",
          "Der Anspruch erlischt automatisch und kann auch freiwillig nicht mehr erfüllt werden.",
          "Viele Forderungen des täglichen Lebens verjähren nach 3 Jahren.",
          "Eine bloße Mahnung hemmt die Verjährung nicht dauerhaft."
        ],
        correctIndices: [0, 2, 3],
        explanation:
          "Verjährung ist eine Einrede. Typische Forderungen verjähren in 3 Jahren; Mahnungen allein unterbrechen die Frist nicht."
      },

      // --- Sachenrecht / Grundbuch-Basics ---
      {
        id: 37,
        topic: "Sachenrecht – Grundsätze",
        text: "Welche Grundsätze des Sachenrechts sind zutreffend?",
        options: [
          "Publizität.",
          "Spezialität.",
          "Typenzwang.",
          "Beliebigkeitsprinzip."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Sachenrechte sind streng typisiert, beziehen sich auf bestimmte Sachen und sollen nach außen erkennbar sein."
      },
      {
        id: 38,
        topic: "Pfandrecht – Grundsätze",
        text: "Welche Grundsätze des Pfandrechts sind richtig?",
        options: [
          "Akzessorietät: Pfandrecht hängt vom Bestand der gesicherten Forderung ab.",
          "Spezialität: Pfandrechte können nur an bestimmten, individualisierten Sachen begründet werden.",
          "Priorität: Rang nach Zeitpunkt der Eintragung.",
          "Publizität spielt keine Rolle."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Akzessorietät, Spezialität, Priorität und Publizität sind zentrale Pfandrechtsgrundsätze."
      },
      {
        id: 39,
        topic: "Servitut",
        text: "Welche Aussagen zu Servituten (Dienstbarkeiten) sind richtig?",
        options: [
          "Sie sind beschränkte dingliche Nutzungsrechte an fremden Sachen.",
          "Der Belastete muss i.d.R. dulden oder unterlassen.",
          "Sie können ersessen werden.",
          "Sie verjähren automatisch nach 5 Jahren Nichtausübung."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Servituten sind beschränkte Nutzungsrechte; Ersitzung ist möglich, die Verjährungsfristen sind sehr lang."
      },
      {
        id: 40,
        topic: "Baurecht",
        text: "Welche Aussagen zum Baurecht (Baurechtsgesetz) sind richtig?",
        options: [
          "Es ist ein selbständiges, veräußerliches und vererbliches Recht an einer fremden Liegenschaft.",
          "Es wird durch Eintragung im Grundbuch begründet.",
          "Es gilt als unbewegliche Sache.",
          "Es darf nur von der öffentlichen Hand vergeben werden."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Baurechte werden grundbücherlich eingetragen und sind wie Liegenschaften zu behandeln; auch Private können Baurechte vereinbaren."
      },
      {
        id: 41,
        topic: "Grundbuch – Aufbau",
        text: "Welche Bestandteile gehören typischerweise zum Grundbuch (vereinfacht)?",
        options: [
          "Hauptbuch mit A-, B- und C-Blatt.",
          "Urkundensammlung.",
          "Kataster (Grundstücksverzeichnis).",
          "Flächenwidmungsplan."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Flächenwidmungspläne gehören zur Raumordnung, nicht zum Grundbuch."
      },
      {
        id: 42,
        topic: "Grundbuch – Blätter",
        text: "Welche Zuordnungen sind korrekt?",
        options: [
          "A-Blatt: Gutsbestand / Widmung / Grundstücksdaten.",
          "B-Blatt: Eigentumsverhältnisse.",
          "C-Blatt: Lasten (Hypotheken, Dienstbarkeiten, Reallasten).",
          "B-Blatt: Pfandrechte."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Pfandrechte stehen im C-Blatt, nicht im B-Blatt."
      },
      {
        id: 43,
        topic: "Grundbuch – Plombe",
        text: "Welche Aussagen zur Plombe sind zutreffend?",
        options: [
          "Sie zeigt ein anhängiges Grundbuchsgesuch an.",
          "Während der Plombe kann sich der Rechtszustand durch Eintragung ändern.",
          "Nach Einverleibung wird aus der TZ der Plombe die „letzte TZ“.",
          "Sie bedeutet, dass das Grundbuch nicht mehr einsichtig ist."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Die Plombe ist ein Warnhinweis auf laufende Eintragungen; Einsicht bleibt möglich."
      },
      {
        id: 44,
        topic: "Justizberufe",
        text: "Welche Aussagen zu Berufen in der Justiz sind richtig?",
        options: [
          "Richter sind unabhängig und nur dem Gesetz unterworfen.",
          "Staatsanwälte vertreten im Strafverfahren die Anklage.",
          "Rechtsanwälte vertreten und beraten Parteien.",
          "Notare vollziehen Strafurteile."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Notare sind u.a. für Beurkundungen, Verlassenschaften und Gesellschaftsgründungen zuständig, nicht für Strafvollzug."
      }
    ];

    // =======================================================
    // GRUNDBUCH-MODUS – längere Beispielsauszüge
    // =======================================================

    const GRUNDBUCH_QUESTIONS = [
      {
        id: "G1",
        topic: "Grundbuchsauszug 1 – Mehrparteienhaus",
        contextHtml: `<pre>GRUNDBUCH 01305 Meidling                            EINLAGEZAHL 1422
BEZIRKSGERICHT Fünfhaus                            SEITE 1
****************************************************************
Letzte TZ 1146/1996           PLOMBE 1406/1996        Wohnungseigentum
****************************************************************
*******************************  A1 ****************************
GST-NR   GBA (NUTZUNG)    FLÄCHE   GST-ADRESSE
127/105  Baufl. (begrünt)    91   Bräuergasse 10
612      Baufl.             130   Löhnerg. 17
GESAMTFLÄCHE               221 m²

*******************************  A2 ****************************
1 a 439/1963  Sicherheitszone Gendarmerieflugplatz Meidling
3 a 324/1979  Reallast des Gehens und Fahrens über Gst 59/4
              für Gst 612

*******************************  B *****************************
1 ANTEIL: 104/172
   Tupék Gottlieb Wilhelm
   GEB: 1924-05-05    ADR: Anton-Benyag-Straße 9/4, 1010 Wien
   s 581/1954 Wohnungseigentum an W 1
   g 406/1996 Einantwortungsurkunde 1996-04-17 Eigentumsrecht

2 ANTEIL: 68/172
   Kerbl Maria
   GEB: 1945-02-05    ADR: Schloßstr. 8, Bruck/Mur 5631
   s 581/1954 Wohnungseigentum an W 2
   b 766/1971 Schenkungsvertrag 1970-07-27 Eigentumsrecht
   c 347/1981 Belastungs- und Veräußerungsverbot
   d 1145/1996 Änderung der Adresse
   e 1146/1996 Geburtsdatum</pre>`,
        text: "Welche Aussagen zu diesem Auszug (B-Blatt und A-Blatt) sind richtig?",
        options: [
          "Im A1-Blatt sind Grundstücksnummer, Nutzung und Adresse ersichtlich.",
          "Im A2-Blatt sind z.B. öffentliche Lasten und Dienstbarkeiten eingetragen.",
          "Im B-Blatt sieht man die Eigentümer und ihre Anteile.",
          "Im B-Blatt werden ausschließlich Pfandrechte eingetragen."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "A1: Gutsbestand und Adresse; A2: z.B. Reallasten. B-Blatt enthält Eigentümer und Anteile; Pfandrechte stehen im C-Blatt."
      },
      {
        id: "G2",
        topic: "Grundbuchsauszug 1 – Wohnungseigentum",
        contextHtml: `<pre>(Auszug wie bei G1 – B-Blatt mit ANTEIL 104/172 und 68/172, Wohnungseigentum an W1 und W2)</pre>`,
        text: "Welche Aussagen zum Wohnungseigentum in diesem Auszug sind zutreffend?",
        options: [
          "Die Anteile (z.B. 104/172) sind ideelle Miteigentumsanteile an der Liegenschaft.",
          "Mit dem ideellen Anteil ist jeweils Wohnungseigentum an einer bestimmten Wohnung (W1, W2) verbunden.",
          "Wohnungseigentum wird nicht im Grundbuch, sondern nur im Mietvertrag ausgewiesen.",
          "Ohne Eintragung im Grundbuch könnte Wohnungseigentum nicht wirksam begründet werden."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Wohnungseigentum setzt die Eintragung von Miteigentumsanteilen und Zuordnung zu bestimmten Objekten im Grundbuch voraus."
      },
      {
        id: "G3",
        topic: "Grundbuchsauszug 2 – Pfandrechte / C-Blatt",
        contextHtml: `<pre>*******************************  C ****************************
1 a 863/1952 Schuldschein 1952-07-25                  1.566.700,--
   PFANDRECHT
   für Wohnhaus-Wiederaufbaufonds
b 1507/1990 Löschungsverpflichtung zugunsten
   Österreichische Credit-Institut Aktiengesellschaft

4 auf Anteil B-LNR 1
  a 875/1974 112/1976 Urteil 1973-11-10
     PFANDRECHT
     9 % zZ, Kosten 3.846,60, 1.819,10 für
     Immobilienverwertungsgesellschaft mbH

5 auf Anteil B-LNR 2
  a 347/1981
     BELASTUNGS- UND VERÄUSSERUNGSVERBOT für Eva Seifert
  b 1507/1990 VORRANG von LNR 12 vor 5

12 auf Anteil B-LNR 2
  a 1507/1990 Schuldschein und Pfandurkunde 1990-07-18
     PFANDRECHT 8,25 % zZ, höchstens 18 % VZ, NGS 81.000,-- 
     für Österreichische Credit-Institut Aktiengesellschaft
  c 1507/1990 VORRANG von LNR 12 vor 5

HINWEIS: Eintragungen ohne Währungsbezeichnung sind Beträge in ATS.</pre>`,
        text: "Welche Aussagen zu diesem C-Blatt sind richtig?",
        options: [
          "Im C-Blatt sind Pfandrechte und sonstige Lasten (z.B. Belastungs- und Veräußerungsverbote) eingetragen.",
          "Die Eintragung „PFANDRECHT“ kennzeichnet eine Hypothek an der Liegenschaft bzw. an bestimmten Anteilen.",
          "Belastungs- und Veräußerungsverbote beschränken die Verfügungsmacht eines Eigentümers.",
          "Pfandrechte werden ausschließlich im B-Blatt eingetragen."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Lasten wie Pfandrechte und Verbote stehen im C-Blatt. Sie können einzelne Anteile (B-LNR) betreffen."
      },
      {
        id: "G4",
        topic: "Grundbuchsauszug 2 – Rangfolge",
        contextHtml: `<pre>(Fortsetzung C-Blatt wie bei G3 mit Einträgen 1, 4, 5 und 12 sowie dem Vermerk „VORRANG von LNR 12 vor 5“)</pre>`,
        text: "Welche Aussagen zur Rangfolge der Pfandrechte sind zutreffend (vereinfacht)?",
        options: [
          "Grundsätzlich bestimmt die Zeit der Eintragung (TZ) den Rang der Pfandrechte.",
          "Durch einen Vorrangvermerk kann ein später eingetragenes Pfandrecht im Rang vor einem älteren stehen.",
          "Im Verwertungsfall wird nach der Rangordnung aus dem Erlös bezahlt.",
          "Rang spielt bei Hypotheken keine Rolle."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Prioritätsprinzip: ältere Eintragung geht jüngeren vor. Ein im Grundbuch vermerkter Vorrang kann die Reihenfolge ändern."
      },
      {
        id: "G5",
        topic: "Grundbuchsauszug 3 – Liegenschaft mit Dienstbarkeit",
        contextHtml: `<pre>GRUNDBUCH 03201 Umgebung             EINLAGEZAHL 77
****************************************************************
A1
GST-NR   GBA (NUTZUNG)    FLÄCHE   GST-ADRESSE
12/3     Landw. Nutzfl.   4.520    Feldweg 2

A2
1 a 210/1980  Dienstbarkeit des Gehens und Fahrens
              zugunsten EZ 76 (Zufahrtsrecht zum Hof)

B
1 ANTEIL: 1/1
   Franz Feld, Landwirt
   ADR: Feldweg 2, 2300 Beispielstadt

C
1 a 210/1980  Dienstbarkeit des Gehens und Fahrens
              für EZ 76 über Gst 12/3</pre>`,
        text: "Welche Aussagen zu diesem Auszug sind richtig?",
        options: [
          "EZ 77 ist die dienende Liegenschaft – sie muss das Geh- und Fahrrecht dulden.",
          "EZ 76 ist die herrschende Liegenschaft – sie darf das Geh- und Fahrrecht ausüben.",
          "Die Dienstbarkeit ist nur im A2-Blatt eingetragen, daher wirkt sie nicht gegenüber Dritten.",
          "Die Dienstbarkeit ist im A2- und im C-Blatt ersichtlich."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Die dienende Liegenschaft trägt die Belastung, die herrschende nutzt das Recht. Dienstbarkeiten erscheinen im A2- und C-Blatt."
      },
      {
        id: "G6",
        topic: "Grundbuchsauszug 3 – Verkauf",
        contextHtml: `<pre>(Auszug wie G5 – EZ 77 mit Dienstbarkeit zugunsten EZ 76)</pre>`,
        text: "Was gilt beim Verkauf der Liegenschaft EZ 77 an einen Dritten?",
        options: [
          "Die Dienstbarkeit bleibt bestehen, weil sie ein dingliches Recht ist.",
          "Der neue Eigentümer muss das Geh- und Fahrrecht weiterhin dulden.",
          "Die Dienstbarkeit erlischt automatisch mit dem Verkauf.",
          "Der neue Eigentümer kann die Dienstbarkeit ohne Zustimmung der herrschenden Liegenschaft löschen lassen."
        ],
        correctIndices: [0, 1],
        explanation:
          "Dingliche Rechte wirken gegenüber Rechtsnachfolgern. Löschung erfordert einvernehmlichen Antrag und Verbücherung."
      },
      {
        id: "G7",
        topic: "Grundbuchsauszug 4 – Plombe & Eigentumserwerb",
        contextHtml: `<pre>GRUNDBUCH 01015 Favoriten           EINLAGEZAHL 987
****************************************************************
A1
GST-NR   GBA (NUTZUNG)   FLÄCHE   GST-ADRESSE
45/1     Baufl.          380      Neubaugasse 5

B (Auszug alt)
1 ANTEIL: 1/1   Peter Muster

C
(keine Eintragungen)

Aktuelle TESTDATEN:
Letzte TZ 1123/2025
PLOMBE 1123/2025  (Ansuchen auf Einverleibung Kaufvertrag zugunsten Maria Neu)</pre>`,
        text: "Welche Aussagen zu dieser Plombe sind richtig?",
        options: [
          "Die Plombe zeigt ein laufendes Ansuchen auf Einverleibung eines Kaufvertrages an.",
          "Bis zur Entscheidung über das Ansuchen kann sich der Eigentümerstand ändern.",
          "Während der Plombe ist das Grundbuch für Dritte nicht einsichtig.",
          "Auf den aktuellen Eigentümerstand kann nur eingeschränkt vertraut werden."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Die Plombe warnt vor einer möglichen Änderung. Einsicht bleibt möglich, aber der Rechtszustand ist „in Bewegung“."
      },
      {
        id: "G8",
        topic: "Grundbuchsauszug 4 – nach der Einverleibung",
        contextHtml: `<pre>B (nach Einverleibung)
1 ANTEIL: 1/1   Peter Muster    (gelöscht)
2 ANTEIL: 1/1   Maria Neu       (Kaufvertrag TZ 1123/2025)</pre>`,
        text: "Welche Aussagen zum Eigentumserwerb sind korrekt?",
        options: [
          "Maria Neu wurde erst durch Einverleibung im B-Blatt Eigentümerin.",
          "Der Kaufvertrag allein ohne Verbücherung hätte keine dingliche Wirkung gegenüber Dritten.",
          "Peter Muster ist nun nicht mehr als Eigentümer im Grundbuch eingetragen.",
          "Für Eigentumserwerb an Liegenschaften reicht die Unterfertigung des Kaufvertrages aus."
        ],
        correctIndices: [0, 1, 3 - 1], // 0,1,2
        explanation:
          "Bei Liegenschaften entsteht Eigentum grundsätzlich mit Einverleibung im Grundbuch (Eintragungsprinzip). Der bloße Vertrag wirkt schuldrechtlich."
      },
      {
        id: "G9",
        topic: "Grundbuchsauszug 5 – Reallast",
        contextHtml: `<pre>GRUNDBUCH 04567 Land               EINLAGEZAHL 333
****************************************************************
A1
GST-NR   GBA (NUTZUNG)   FLÄCHE   GST-ADRESSE
3/1      Hofstelle       980      Hofgasse 1

B
1 ANTEIL: 1/1   Bauernhof GmbH

C
1 a 510/1995 Reallast: lebenslängliches Wohn- und Versorgungsrecht
           zugunsten Frau Altbauerin, geb. 1940
           (Wohnrecht im Erdgeschoß und Naturalunterhalt)</pre>`,
        text: "Welche Aussagen zur Reallast sind richtig?",
        options: [
          "Sie ist eine dingliche Belastung der Liegenschaft zugunsten einer bestimmten Person.",
          "Sie kann z.B. ein Wohn- und Versorgungsrecht sichern.",
          "Sie wirkt auch gegenüber Rechtsnachfolgern der Eigentümerin.",
          "Sie ist nur ein schuldrechtlicher Anspruch und wird nicht im Grundbuch eingetragen."
        ],
        correctIndices: [0, 1, 2],
        explanation:
          "Reallasten sind dingliche Rechte im C-Blatt, die auch gegenüber späteren Eigentümern wirken."
      },
      {
        id: "G10",
        topic: "Grundbuchsauszug 6 – mehrere Pfandrechte",
        contextHtml: `<pre>GRUNDBUCH 01001 Innere Stadt       EINLAGEZAHL 999
****************************************************************
C
1 a 100/2020 Hypothek EUR 500.000,-- zugunsten Erste Bank
2 a 300/2023 Hypothek EUR 200.000,-- zugunsten Zweite Bank</pre>`,
        text: "Welche Aussagen zu Rang und Verwertung sind zutreffend?",
        options: [
          "Die Hypothek der Ersten Bank hat aufgrund der älteren TZ den besseren Rang.",
          "Im Verwertungsfall wird die Erste Bank vor der Zweiten Bank befriedigt.",
          "Die zweite Hypothek ist automatisch unwirksam, weil schon eine Hypothek besteht.",
          "Der Rang richtet sich nach der Reihenfolge der Eintragungen."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Mehrere Hypotheken sind möglich; die Befriedigung erfolgt nach Rang (Prioritätsprinzip)."
      },
      {
        id: "G11",
        topic: "Grundbuchsauszug 7 – Löschung einer Hypothek",
        contextHtml: `<pre>C (alt)
1 a 100/2010 Hypothek EUR 200.000,-- zugunsten Sparkasse

C (neu)
1 a 100/2010 Hypothek ...  (gelöscht)
  b 850/2025 Löschungsbewilligung der Sparkasse</pre>`,
        text: "Welche Aussagen zur Löschung der Hypothek sind korrekt?",
        options: [
          "Für die Löschung ist eine Löschungsbewilligung des Pfandgläubigers erforderlich.",
          "Die Löschung wird im Grundbuch als eigene Eintragung vermerkt.",
          "Mit Tilgung der Forderung erlischt das Pfandrecht automatisch, auch ohne Löschung.",
          "Erst mit Verbücherung der Löschung ist die Hypothek grundbücherlich beseitigt."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Tilgung der Forderung ist Voraussetzung, aber rechtlich maßgeblich ist die Löschung im Grundbuch."
      },
      {
        id: "G12",
        topic: "Grundbuchsauszug 8 – Rangordnung",
        contextHtml: `<pre>GRUNDBUCH 02002 Leopoldstadt       EINLAGEZAHL 777
****************************************************************
B
1 ANTEIL: 1/1    Bauträger GmbH

C
1 a 200/2024 Anmerkung der Rangordnung für die beabsichtigte Veräußerung
             (Bauträgervertrag – Wohnungseigentumsbegründung)</pre>`,
        text: "Welche Aussagen zur Anmerkung der Rangordnung sind richtig (vereinfacht)?",
        options: [
          "Sie sichert künftigen Erwerbern einen bestimmten Rang für ihre Eigentumseinverleibung.",
          "Sie ist v.a. beim Erwerb von Bauträgerwohnungen wichtig.",
          "Ohne Rangordnung kann Wohnungseigentum rechtlich überhaupt nicht begründet werden.",
          "Die Rangordnung wird im C-Blatt angemerkt."
        ],
        correctIndices: [0, 1, 3],
        explanation:
          "Rangordnungen sichern den Rang zukünftiger Einverleibungen, sind aber keine zwingende Voraussetzung für Wohnungseigentum."
      }
    ];

    // =======================================
    // QUIZ-LOGIK – Mehrfachantworten & Modi
    // =======================================

    let currentMode = null;           // "all" oder "grundbuch"
    let currentQuestions = [];
    let questionOrder = [];           // Reihenfolge der Fragen
    let optionOrder = [];             // pro Frage: Permutation der Antwort-Indizes
    let currentOrderIndex = 0;
    let userAnswers = [];             // pro Frage: gewählte Original-Indizes
    let questionChecked = [];         // pro Frage: bereits „Antwort prüfen“ gedrückt?
    let quizFinished = false;

    const MODE_LABELS = {
      all: "Gesamt-Quiz: Öffentliches & Privatrecht",
      grundbuch: "Spezial-Modus: Grundbuchauszüge"
    };

    document.addEventListener("DOMContentLoaded", () => {
      const modeButtons = document.querySelectorAll(".mode-card[data-mode]");
      const modeSelectSection = document.getElementById("mode-select");
      const quizMain = document.getElementById("quiz-main");
      const modeLabel = document.getElementById("current-mode-label");

      const prevBtn = document.getElementById("prev-btn");
      const nextBtn = document.getElementById("next-btn");
      const checkBtn = document.getElementById("check-btn");
      const evalBtn = document.getElementById("eval-btn");
      const backBtn = document.getElementById("back-btn");
      const restartBtn = document.getElementById("restart-btn");
      const closeSolutionBtn = document.getElementById("close-solution-btn");

      modeButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const mode = btn.getAttribute("data-mode");
          currentMode = mode;
          modeLabel.textContent = MODE_LABELS[mode] || "–";
          modeSelectSection.classList.add("hidden");
          quizMain.classList.remove("hidden");
          startQuiz(mode);
        });
      });

      prevBtn.addEventListener("click", showPrevQuestion);
      nextBtn.addEventListener("click", showNextQuestion);
      checkBtn.addEventListener("click", checkCurrentQuestion);
      evalBtn.addEventListener("click", () => {
        evaluateQuiz();
        openSolutionOverlay();
      });

      backBtn.addEventListener("click", () => {
        // Zur Startseite zurück
        currentMode = null;
        currentQuestions = [];
        questionOrder = [];
        optionOrder = [];
        userAnswers = [];
        questionChecked = [];
        currentOrderIndex = 0;
        quizFinished = false;
        document.getElementById("score-banner").classList.add("hidden");
        document.getElementById("solution-overlay").classList.add("hidden");
        quizMain.classList.add("hidden");
        modeSelectSection.classList.remove("hidden");
      });

      restartBtn.addEventListener("click", () => {
        if (!currentMode) return;
        startQuiz(currentMode);
      });

      closeSolutionBtn.addEventListener("click", () => {
        document.getElementById("solution-overlay").classList.add("hidden");
      });

      // Tastatursteuerung
      document.addEventListener("keydown", (e) => {
        if (!currentQuestions.length) return;
        if (e.key === "ArrowRight") {
          showNextQuestion();
        } else if (e.key === "ArrowLeft") {
          showPrevQuestion();
        } else if (e.key === "Enter") {
          e.preventDefault();
          checkCurrentQuestion();
        }
      });
    });

    function startQuiz(mode) {
      currentQuestions =
        mode === "grundbuch" ? GRUNDBUCH_QUESTIONS : ALL_QUESTIONS;

      // Frage-Reihenfolge mischen
      questionOrder = currentQuestions.map((_, idx) => idx);
      shuffle(questionOrder);

      // Antwort-Reihenfolge pro Frage mischen
      optionOrder = currentQuestions.map((q) => {
        const arr = q.options.map((_, idx) => idx);
        shuffle(arr);
        return arr;
      });

      currentOrderIndex = 0;
      userAnswers = currentQuestions.map(() => []);
      questionChecked = currentQuestions.map(() => false);
      quizFinished = false;

      const scoreBanner = document.getElementById("score-banner");
      scoreBanner.classList.add("hidden");
      scoreBanner.classList.remove("positive", "negative");
      document.getElementById("solution-overlay").classList.add("hidden");

      renderCurrentQuestion();
      updateProgressInfo();
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function renderCurrentQuestion() {
      if (!currentQuestions.length) return;
      const questionContainer = document.getElementById("question-container");
      const total = currentQuestions.length;
      const qIndex = questionOrder[currentOrderIndex];
      const q = currentQuestions[qIndex];
      const order = optionOrder[qIndex];

      const optionHtml = order
        .map((origIdx, dispIdx) => {
          const optText = q.options[origIdx];
          const selected =
            (userAnswers[qIndex] || []).includes(origIdx) ? "checked" : "";
          const letter = String.fromCharCode(97 + dispIdx); // a,b,c,...
          return `
            <label class="option">
              <input type="checkbox" data-orig-index="${origIdx}" ${selected}>
              <span class="option-letter">${letter})</span>
              <span class="option-text">${optText}</span>
            </label>
          `;
        })
        .join("");

      const contextHtml = q.contextHtml
        ? `<div class="question-context">${q.contextHtml}</div>`
        : "";

      const explanationHtml = `
        <div class="explanation hidden" id="explanation">
          <strong>Lösung:</strong><br>
          ${q.explanation}
        </div>
      `;

      questionContainer.innerHTML = `
        <div class="question-card" id="question-card">
          <div class="question-header">
            <div class="question-number">Frage ${
              currentOrderIndex + 1
            } von ${total}</div>
            <div class="question-topic">${q.topic || ""}</div>
          </div>
          <div class="question-text">${q.text}</div>
          ${contextHtml}
          <div class="question-note">
            Mehrfachauswahl möglich – mindestens eine Antwort ist richtig.
          </div>
          <div class="options">
            ${optionHtml}
          </div>
          ${explanationHtml}
          <div class="message" id="message"></div>
        </div>
      `;

      // Wenn die Frage bereits geprüft wurde, Darstellung wiederherstellen
      if (questionChecked[qIndex]) {
        const card = document.getElementById("question-card");
        const selected = userAnswers[qIndex] || [];
        applyEvaluationStyles(card, q, selected, qIndex);
        const explEl = document.getElementById("explanation");
        if (explEl) explEl.classList.remove("hidden");

        const msgEl = document.getElementById("message");
        if (msgEl) {
          const qScore = computeQuestionScorePercent(q, selected);
          const rounded = Math.round(qScore);
          msgEl.textContent = buildQuestionMessage(rounded);
        }
      }

      updateProgressInfo();
    }

    function showPrevQuestion() {
      if (!currentQuestions.length) return;
      if (currentOrderIndex > 0) {
        currentOrderIndex -= 1;
        renderCurrentQuestion();
      }
    }

    function showNextQuestion() {
      if (!currentQuestions.length) return;
      if (currentOrderIndex < questionOrder.length - 1) {
        currentOrderIndex += 1;
        renderCurrentQuestion();
      }
    }

    function checkCurrentQuestion() {
      if (!currentQuestions.length) return;
      const qIndex = questionOrder[currentOrderIndex];
      const q = currentQuestions[qIndex];
      const card = document.getElementById("question-card");
      if (!card) return;

      const checkboxes = card.querySelectorAll('input[type="checkbox"]');
      const selectedOriginalIndices = [];
      checkboxes.forEach((cb) => {
        if (cb.checked) {
          const orig = parseInt(cb.getAttribute("data-orig-index"), 10);
          selectedOriginalIndices.push(orig);
        }
      });

      const messageEl = document.getElementById("message");
      if (!selectedOriginalIndices.length) {
        if (messageEl) {
          messageEl.textContent =
            "Bitte wähle mindestens eine Antwort aus, bevor du prüfst.";
        }
        return;
      } else if (messageEl) {
        messageEl.textContent = "";
      }

      userAnswers[qIndex] = selectedOriginalIndices;
      questionChecked[qIndex] = true;

      applyEvaluationStyles(card, q, selectedOriginalIndices, qIndex);

      const qScore = computeQuestionScorePercent(q, selectedOriginalIndices);
      const rounded = Math.round(qScore);
      if (messageEl) {
        messageEl.textContent = buildQuestionMessage(rounded);
      }

      const explEl = document.getElementById("explanation");
      if (explEl) explEl.classList.remove("hidden");

      updateProgressInfo();
    }

    function buildQuestionMessage(percent) {
      if (percent === 100) return "Frage-Punkte: 100 % – voll korrekt.";
      if (percent >= 60)
        return `Frage-Punkte: ${percent} % – positiv, aber nicht alles richtig.`;
      if (percent > 0)
        return `Frage-Punkte: ${percent} % – teilweise richtig, aber noch negativ (< 60 %).`;
      return "Frage-Punkte: 0 % – keine Punkte, siehe Erklärung.";
    }

    function applyEvaluationStyles(card, question, selectedOriginalIndices, qIndex) {
      const optionsEls = card.querySelectorAll(".option");
      const selectedSet = new Set(selectedOriginalIndices);
      const correctSet = new Set(question.correctIndices);
      const order = optionOrder[qIndex];

      optionsEls.forEach((optEl, dispIdx) => {
        optEl.classList.remove("correct", "incorrect", "unselected-correct");
        const origIdx = order[dispIdx];
        const isSelected = selectedSet.has(origIdx);
        const isCorrect = correctSet.has(origIdx);

        if (isCorrect && isSelected) {
          optEl.classList.add("correct");
        } else if (!isCorrect && isSelected) {
          optEl.classList.add("incorrect");
        } else if (isCorrect && !isSelected) {
          optEl.classList.add("unselected-correct");
        }
      });
    }

    function computeQuestionScorePercent(question, selectedOriginalIndices) {
      if (!selectedOriginalIndices || !selectedOriginalIndices.length) {
        return 0;
      }
      const totalOptions = question.options.length;
      const correctSet = new Set(question.correctIndices);
      const totalCorrect = correctSet.size;
      if (totalCorrect === 0) return 0;

      const allIdx = [];
      for (let i = 0; i < totalOptions; i++) allIdx.push(i);
      const incorrectIndices = allIdx.filter((i) => !correctSet.has(i));
      const totalIncorrect = incorrectIndices.length;

      const selSet = new Set(selectedOriginalIndices);
      let correctSelected = 0;
      let incorrectSelected = 0;

      selSet.forEach((idx) => {
        if (correctSet.has(idx)) {
          correctSelected++;
        } else if (incorrectIndices.includes(idx)) {
          incorrectSelected++;
        }
      });

      const pos = correctSelected / totalCorrect;
      let neg = 0;
      if (totalIncorrect > 0) {
        neg = incorrectSelected / totalIncorrect;
      }

      let score = (pos - neg) * 100;
      if (score < 0) score = 0;
      if (score > 100) score = 100;
      return score;
    }

    function updateProgressInfo() {
      const total = currentQuestions.length || 0;
      const infoCurrent = document.getElementById("info-current-question");
      const infoTotal = document.getElementById("info-total-questions");
      const infoChecked = document.getElementById("info-checked");
      const infoAverage = document.getElementById("info-average");

      if (infoCurrent) {
        infoCurrent.textContent = total
          ? String(currentOrderIndex + 1)
          : "–";
      }
      if (infoTotal) {
        infoTotal.textContent = total ? String(total) : "–";
      }

      let checkedCount = 0;
      let sumScore = 0;
      currentQuestions.forEach((q, idx) => {
        if (questionChecked[idx]) {
          checkedCount++;
          sumScore += computeQuestionScorePercent(q, userAnswers[idx]);
        }
      });

      if (infoChecked) {
        infoChecked.textContent = total ? String(checkedCount) : "–";
      }
      if (infoAverage) {
        const avg = checkedCount ? Math.round(sumScore / checkedCount) : 0;
        infoAverage.textContent = checkedCount ? `${avg} %` : "–";
      }
    }

    function evaluateQuiz() {
      if (!currentQuestions.length) return;
      const total = currentQuestions.length;
      let sumScore = 0;

      currentQuestions.forEach((q, idx) => {
        const ans = userAnswers[idx] || [];
        sumScore += computeQuestionScorePercent(q, ans);
      });

      const overallPercent = total ? sumScore / total : 0;
      const roundedOverall = Math.round(overallPercent);
      const gradeText = getGradeText(roundedOverall);

      const scoreBanner = document.getElementById("score-banner");
      const scorePercent = document.getElementById("score-percent");
      const scoreGrade = document.getElementById("score-grade");
      const scoreDetails = document.getElementById("score-details");

      if (scorePercent) scorePercent.textContent = `${roundedOverall} %`;
      if (scoreGrade) scoreGrade.textContent = gradeText;
      if (scoreDetails) {
        scoreDetails.textContent = `Durchschnitt über alle ${
          total
        } Fragen: ${roundedOverall} %.`;
      }

      if (scoreBanner) {
        scoreBanner.classList.remove("hidden", "positive", "negative");
        if (roundedOverall >= 60) {
          scoreBanner.classList.add("positive");
        } else {
          scoreBanner.classList.add("negative");
        }
      }

      quizFinished = true;
    }

    function getGradeText(percent) {
      if (percent >= 90) return "Note 1 – Sehr gut (positiv)";
      if (percent >= 80) return "Note 2 – Gut (positiv)";
      if (percent >= 70) return "Note 3 – Befriedigend (positiv)";
      if (percent >= 60) return "Note 4 – Genügend (positiv)";
      return "Note 5 – Nicht genügend (negativ)";
    }

    // Lösungs-Overlay

    function openSolutionOverlay() {
      if (!currentQuestions.length) return;

      const total = currentQuestions.length;
      let sumScore = 0;
      const perQuestionScores = [];

      currentQuestions.forEach((q, idx) => {
        const score = computeQuestionScorePercent(q, userAnswers[idx] || []);
        sumScore += score;
        perQuestionScores.push(score);
      });

      const overallPercent = total ? sumScore / total : 0;
      const roundedOverall = Math.round(overallPercent);
      const gradeText = getGradeText(roundedOverall);

      const summaryEl = document.getElementById("solution-summary");
      summaryEl.innerHTML = `
        Gesamtpunkte: <b>${roundedOverall} %</b> – ${gradeText}<br>
        Fragenzahl: <b>${total}</b>. Mindestens 60 % = positiv.
      `;

      const listEl = document.getElementById("solution-list");
      listEl.innerHTML = "";

      questionOrder.forEach((qOrderIdx, idxInOrder) => {
        const q = currentQuestions[qOrderIdx];
        const score = perQuestionScores[qOrderIdx] || 0;
        const rounded = Math.round(score);
        const positive = rounded >= 60;
        const orderArr = optionOrder[qOrderIdx];
        const correctSet = new Set(q.correctIndices);
        const selectedSet = new Set(userAnswers[qOrderIdx] || []);

        let optionsHtml = "";
        orderArr.forEach((origIdx, dispIdx) => {
          const text = q.options[origIdx];
          const isCorrect = correctSet.has(origIdx);
          const wasSelected = selectedSet.has(origIdx);

          let mark = "";
          let cssClass = "opt-neutral";

          if (isCorrect && wasSelected) {
            mark = "✓";
            cssClass = "opt-correct";
          } else if (isCorrect && !wasSelected) {
            mark = "✓";
            cssClass = "opt-neutral";
          } else if (!isCorrect && wasSelected) {
            mark = "✗";
            cssClass = "opt-wrong-selected";
          } else {
            mark = "•";
            cssClass = "opt-neutral";
          }

          const letter = String.fromCharCode(97 + dispIdx);
          optionsHtml += `
            <div class="solution-opt ${cssClass}">
              <div class="solution-opt-mark">${mark}</div>
              <div><b>${letter})</b> ${text}</div>
            </div>
          `;
        });

        const scoreClass = positive ? "positive" : "negative";

        const blockHtml = `
          <div class="solution-question">
            <div class="solution-q-header">
              <div class="solution-q-title">Frage ${idxInOrder + 1} – ${
          q.id
        }</div>
              <div class="solution-q-topic">${q.topic || ""}</div>
            </div>
            <div>${q.text}</div>
            <div class="solution-q-score ${scoreClass}">
              Punkte: ${rounded} %
            </div>
            <div class="solution-options">
              ${optionsHtml}
            </div>
            <div class="solution-expl">${q.explanation}</div>
          </div>
        `;
        listEl.insertAdjacentHTML("beforeend", blockHtml);
      });

      document.getElementById("solution-overlay").classList.remove("hidden");
    }
  </script>
</body>
</html>
